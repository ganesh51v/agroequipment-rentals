<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>User Profile</title>
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* Custom styles for profile page */
    .profile-page {
      display: flex;
      min-height: 100vh;
      background-color: var(--gray-50);
      font-family: var(--font-primary);
    }
    .sidebar {
      width: 250px;
      background: white;
      box-shadow: var(--shadow-lg);
      padding: 2rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .profile-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .profile-info img {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
    }
    .profile-info .greeting {
      font-size: 0.9rem;
      color: var(--gray-600);
    }
    .profile-info .name {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--gray-900);
    }
    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: var(--gray-700);
      text-decoration: none;
      border-radius: 0.5rem;
      font-weight: 500;
      transition: var(--transition);
    }
    .sidebar nav a.active,
    .sidebar nav a:hover {
      background: var(--primary-green);
      color: white;
      box-shadow: var(--shadow-md);
    }
    .sidebar nav a i {
      font-size: 1.1rem;
    }
    .content {
      flex-grow: 1;
      padding: 3rem 4rem;
      background: var(--gray-50);
    }
    .content h2 {
      font-weight: 700;
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--gray-900);
    }
    .profile-form {
      background: white;
      padding: 2rem 3rem;
      border-radius: 1rem;
      box-shadow: var(--shadow-lg);
      max-width: 700px;
    }
    .profile-picture-wrapper {
      position: relative;
      width: 100px;
      height: 100px;
      margin-bottom: 1rem;
    }
    .profile-picture-wrapper img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--primary-green-light);
    }
    .edit-icon {
      position: absolute;
      bottom: 0;
      right: 0;
      background: white;
      border-radius: 50%;
      border: 2px solid var(--primary-green);
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }
    .edit-icon:hover {
      background: var(--primary-green);
      color: white;
    }
    .edit-icon svg {
      width: 16px;
      height: 16px;
      stroke: var(--primary-green);
    }
    .edit-icon:hover svg {
      stroke: white;
    }
    .change-profile-link {
      color: var(--primary-green);
      font-weight: 600;
      font-size: 0.9rem;
      text-decoration: none;
      float: right;
      margin-bottom: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
    }
    .change-profile-link:hover {
      text-decoration: underline;
    }
    .form-group {
      margin-bottom: 1.5rem;
    }
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--gray-700);
    }
    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="date"] {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1.5px solid var(--gray-200);
      border-radius: 0.5rem;
      font-size: 1rem;
      background: var(--gray-50);
      transition: var(--transition);
    }
    .form-group input[type="text"]:focus,
    .form-group input[type="email"]:focus,
    .form-group input[type="date"]:focus {
      outline: none;
      border-color: var(--primary-green);
      background: white;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
    }
    .gender-group {
      display: flex;
      gap: 2rem;
      align-items: center;
    }
    .gender-group label {
      font-weight: 500;
      color: var(--gray-700);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .gender-group input[type="radio"] {
      accent-color: var(--primary-green);
      cursor: pointer;
      width: 18px;
      height: 18px;
    }
    .phone-input-wrapper {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .phone-flag {
      width: 36px;
      height: 24px;
      border-radius: 4px;
      overflow: hidden;
      flex-shrink: 0;
      border: 1px solid var(--gray-300);
    }
    .phone-flag img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .phone-number-input {
      flex-grow: 1;
      padding: 0.75rem 1rem;
      border: 1.5px solid var(--gray-200);
      border-radius: 0.5rem;
      font-size: 1rem;
      background: var(--gray-50);
      transition: var(--transition);
    }
    .phone-number-input:focus {
      outline: none;
      border-color: var(--primary-green);
      background: white;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
    }
  </style>
</head>
<body>
  <div class="profile-page">
    <aside class="sidebar">
      <div class="profile-info">
        <img src="images/profilelogo.jpg" alt="Profile Picture" />
        <div>
          <div class="greeting">Hello</div>
          <div class="name">Kazi Mahbub</div>
        </div>
      </div>
      <nav>
        <a href="profile.html" class="active"><i class="fas fa-user"></i> My Accounts</a>
        <a href="my-orders.html"><i class="fas fa-shopping-basket"></i> My Orders</a>
        <a href="returns-cancel.html"><i class="fas fa-ban"></i> Returns & Cancel</a>
        <a href="ratings-reviews.html"><i class="fas fa-star"></i> My Rating & Reviews</a>
        <a href="wishlist.html"><i class="fas fa-heart"></i> My Wishlist</a>
        <a href="payment.html"><i class="fas fa-credit-card"></i> Payment</a>
        <a href="change-password.html"><i class="fas fa-key"></i> Change Password</a>
      </nav>
    </aside>
    <main class="content">
      <h2>Personal Information</h2>
      <a href="#" class="change-profile-link">Change Profile Information</a>
      <form class="profile-form" action="#" method="POST">
        <div class="profile-picture-wrapper">
          <img src="images/profilelogo.jpg" alt="Profile Picture" />
          <div class="edit-icon" title="Edit Profile Picture" tabindex="0" role="button" aria-label="Edit Profile Picture">
            <svg fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
              <path d="M12 20h9"></path>
              <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"></path>
            </svg>
          </div>
        </div>
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" name="name" type="text" value="Kazi Mahbub" />
        </div>
        <div class="form-group">
          <label for="dob">Date Of Birth</label>
          <input id="dob" name="dob" type="date" value="2022-01-20" />
        </div>
        <div class="form-group">
          <label>Gender</label>
          <div class="gender-group">
            <label><input type="radio" name="gender" value="male" checked /> Male</label>
            <label><input type="radio" name="gender" value="female" /> Female</label>
          </div>
        </div>
        <div class="form-group">
          <label for="phone">Phone Number</label>
          <div class="phone-input-wrapper">
            <div class="phone-flag">
              <img src="images/flag-turkey.png" alt="Turkey Flag" />
            </div>
            <input id="phone" name="phone" type="text" class="phone-number-input" value="+90-123456789" />
          </div>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" value="abcd1234@email.com" />
        </div>
      </form>
    </main>
  </div>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const storedUser = localStorage.getItem('user');
      if (!storedUser) {
        // Redirect to login if no user data
        window.location.href = 'login.html';
        return;
      }
      try {
        const user = JSON.parse(storedUser);

        // Update sidebar name
        const sidebarName = document.querySelector('.sidebar .profile-info .name');
        if (sidebarName && user.name) {
          sidebarName.textContent = user.name;
        }

        // Update profile picture
        const profilePics = document.querySelectorAll('.profile-info img, .profile-picture-wrapper img');
        profilePics.forEach(img => {
          if (user.avatar) {
            img.src = '/uploads/' + user.avatar;
          } else {
            img.src = 'images/profilelogo.jpg';
          }
        });

        // Populate form fields
        const nameInput = document.getElementById('name');
        if (nameInput && user.name) nameInput.value = user.name;

        const emailInput = document.getElementById('email');
        if (emailInput && user.email) emailInput.value = user.email;

        const phoneInput = document.getElementById('phone');
        if (phoneInput && user.phone) phoneInput.value = user.phone;

        const dobInput = document.getElementById('dob');
        if (dobInput && user.dob) dobInput.value = user.dob;

        // Set gender radio buttons
        if (user.gender) {
          const genderMale = document.querySelector('input[name="gender"][value="male"]');
          const genderFemale = document.querySelector('input[name="gender"][value="female"]');
          if (user.gender.toLowerCase() === 'male' && genderMale) {
            genderMale.checked = true;
          } else if (user.gender.toLowerCase() === 'female' && genderFemale) {
            genderFemale.checked = true;
          }
        }

        // Update phone flag based on country code if available
        const phoneFlagImg = document.querySelector('.phone-flag img');
        if (phoneFlagImg && user.countryCode) {
          // Map country codes to flag images (example for Turkey)
          const countryFlags = {
            'TR': 'images/flag-turkey.png',
            // Add more country codes and flag images as needed
          };
          if (countryFlags[user.countryCode]) {
            phoneFlagImg.src = countryFlags[user.countryCode];
          }
        }
      } catch (e) {
        console.error('Error parsing user data:', e);
        window.location.href = 'login.html';
      }
    });
  </script>
  </body>
</html>
